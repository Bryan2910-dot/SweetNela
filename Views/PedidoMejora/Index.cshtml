@model SweetNela.Models.PedidoMejora
@{
    Layout = null; // Mantenemos null para que sea una p치gina independiente
    ViewBag.Title = "Personaliza tu Pedido"; // T칤tulo m치s descriptivo
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - SweetNela</title>
    <link rel="icon" href="~/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="~/css/PedidoMejora.css" asp-append-version="true" />
</head>
<body>
    <div class="sidebar">
        <h2 class="sidebar-brand">SweetNela <span>游꺜</span></h2>
        <ul class="sidebar-menu">
            <li>
                <a asp-area="" asp-controller="Home" asp-action="Index">
                    <i class="fas fa-home me-2"></i>Inicio
                </a>
            </li>
            <li>
                <a asp-area="" asp-controller="Carrito" asp-action="Index">
                    <i class="fas fa-shopping-cart me-2"></i>Carrito
                </a>
            </li>
            <li class="active">
                <a class="nav-link" href="#">
                    <i class="fas fa-edit me-2"></i>Pedido Personalizado
                </a>
            </li>
            </ul>
        <div class="sidebar-footer">
            <p>춰Crea tu dulce perfecto!</p>
        </div>
    </div>

    <div class="form-main-content">
        <div class="form-container">
            <h2 class="form-title">Personaliza Tu Torta</h2>
            <form method="post" asp-action="PedidoMejora" class="custom-form">
                <div class="form-group">
                    <label for="sabor">Elige el Sabor de tu Torta:</label>
                    <div id="sabor-container" class="options-grid">
                        <button type="button" class="sabor-opcion" data-sabor="Chocolate">
                            <img src="~/imagenes/CHOCOLATE.jpeg" alt="Sabor Chocolate" class="img-fluid rounded-circle"><br>
                            <span>Chocolate</span>
                        </button>
                        <button type="button" class="sabor-opcion" data-sabor="Vainilla">
                            <img src="~/imagenes/VAINILLA.jpg" alt="Sabor Vainilla" class="img-fluid rounded-circle"><br>
                            <span>Vainilla</span>
                        </button>
                        <button type="button" class="sabor-opcion" data-sabor="Keke ingles">
                            <img src="~/imagenes/INGLES.jpg" alt="Sabor Keke Ingl칠s" class="img-fluid rounded-circle"><br>
                            <span>Keke Ingl칠s</span>
                        </button>
                        <button type="button" class="sabor-opcion" data-sabor="Red Velvet">
                            <img src="~/imagenes/red velvey.png" alt="Sabor Red Velvet" class="img-fluid rounded-circle"><br>
                            <span>Red Velvet</span>
                        </button>
                    </div>
                    <input type="hidden" id="sabor" name="Sabor" required data-error-message="Por favor, selecciona un sabor.">
                    <div class="error-message" id="sabor-error"></div>
                </div>

                <div class="form-group">
                    <label for="tama침o">Selecciona el Tama침o:</label>
                    <div id="tama침o" class="options-grid">
                        <div class="tamano-opcion-card">
                            <input type="radio" id="tamano-mediano" name="Tama침o" value="Mediano" class="d-none" />
                            <label for="tamano-mediano">
                                <img src="~/imagenes/mediano.jpeg" alt="Tama침o Mediano" class="img-fluid rounded"><br>
                                <span>MEDIANO</span>
                            </label>
                        </div>
                        <div class="tamano-opcion-card">
                            <input type="radio" id="tamano-grande" name="Tama침o" value="Grande" class="d-none" />
                            <label for="tamano-grande">
                                <img src="~/imagenes/grande.jpeg" alt="Tama침o Grande" class="img-fluid rounded"><br>
                                <span>GRANDE</span>
                            </label>
                        </div>
                        <div class="tamano-opcion-card">
                            <input type="radio" id="tamano-extra-grande" name="Tama침o" value="Extra Grande" class="d-none" />
                            <label for="tamano-extra-grande">
                                <img src="~/imagenes/mega grande.jpeg" alt="Tama침o Extra Grande" class="img-fluid rounded"><br>
                                <span>EXTRA GRANDE</span>
                            </label>
                        </div>
                    </div>
                    <div class="error-message" id="tama침o-error"></div>
                </div>

                <div class="form-group">
                    <label for="relleno">Elige el Relleno:</label>
                    <select class="form-select" id="relleno" name="Relleno" required>
                        <option value="">-- Selecciona un relleno --</option>
                        <option value="Manjar blanco">Manjar blanco</option>
                        <option value="Fudge">Fudge</option>
                        <option value="Oreo trozada">Oreo trozada</option>
                        <option value="Chin chin">Chin chin</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="detalles">Detalles Adicionales / Tem치tica:</label>
                    <textarea class="form-control" id="detalles" name="Detalles" rows="3" placeholder="Ej: tem치tica de unicornio, con mensaje 'Feliz Cumplea침os', etc."></textarea>
                </div>

                <div class="form-row-group">
                    <div class="form-group">
                        <label for="fecha">Fecha de Entrega:</label>
                        <input type="date" class="form-control" id="fecha" name="Fecha" required />
                    </div>
                    <div class="form-group">
                        <label for="hora">Hora de Entrega:</label>
                        <input type="time" class="form-control" id="hora" name="Hora" required />
                    </div>
                </div>

                <div class="form-group">
                    <label for="lugar">Lugar de Entrega (Direcci칩n):</label>
                    <input type="text" class="form-control" id="lugar" name="Lugar" placeholder="Ej: Av. Las Flores 123, Urb. Primavera" required />
                </div>

                <div class="form-actions">
                    <button type="button" id="btnCalcular" class="btn btn-secondary"><i class="fas fa-calculator me-2"></i>Calcular Precio</button>
                    <button type="submit" id="btnAceptar" class="btn btn-primary"><i class="fas fa-check-circle me-2"></i>Confirmar Pedido</button>
                </div>
            </form>

            <div class="result-section">
                <h3>Resumen de Tu Pedido:</h3>
                <p id="resultadoPrecio" class="result-text">
                    @if (!string.IsNullOrEmpty(ViewData["Resultado"]?.ToString()))
                    {
                        @ViewData["Resultado"]
                    }
                    else
                    {
                        <span>El precio se mostrar치 aqu칤 despu칠s de calcular.</span>
                    }
                </p>
            </div>
        </div>
    </div>

    <script src="~/js/pedidoMejora.js" asp-append-version="true"></script>
    <script>
        // L칩gica de selecci칩n de sabor y tama침o (adaptada a los nuevos elementos)
        document.addEventListener('DOMContentLoaded', function () {
            // Sabor
            const saborButtons = document.querySelectorAll('.sabor-opcion');
            const saborInput = document.getElementById('sabor');
            const saborError = document.getElementById('sabor-error');

            saborButtons.forEach(button => {
                button.addEventListener('click', function () {
                    saborButtons.forEach(btn => btn.classList.remove('selected'));
                    this.classList.add('selected');
                    saborInput.value = this.dataset.sabor;
                    saborError.textContent = ''; // Limpiar mensaje de error al seleccionar
                });
            });

            // Validaci칩n al enviar el formulario (ejemplo b치sico)
            document.querySelector('.custom-form').addEventListener('submit', function(event) {
                if (!saborInput.value) {
                    saborError.textContent = saborInput.dataset.errorMessage;
                    event.preventDefault(); // Detener el env칤o si no hay sabor
                }

                // Validaci칩n para tama침os (al menos uno debe estar seleccionado)
                const tamanoRadios = document.querySelectorAll('input[name="Tama침o"]');
                const tamanoError = document.getElementById('tama침o-error');
                let tamanoSeleccionado = false;
                tamanoRadios.forEach(radio => {
                    if (radio.checked) {
                        tamanoSeleccionado = true;
                    }
                });
                if (!tamanoSeleccionado) {
                    tamanoError.textContent = 'Por favor, selecciona un tama침o.';
                    event.preventDefault();
                } else {
                    tamanoError.textContent = '';
                }
            });

            // L칩gica para seleccionar solo una opci칩n de tama침o
            const tamanoRadios = document.querySelectorAll('input[name="Tama침o"]');
            tamanoRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const labels = document.querySelectorAll('.tamano-opcion-card label');
                    labels.forEach(label => label.classList.remove('selected'));
                    if (this.checked) {
                        this.closest('.tamano-opcion-card').querySelector('label').classList.add('selected');
                    }
                });
            });
        });

        // Aseg칰rate de que tu `pedidoMejora.js` contenga la l칩gica de `seleccionarSabor`
        // y la l칩gica para el bot칩n "Calcular", que usar치 los valores de los campos del formulario.
        // Ejemplo simplificado de c칩mo `seleccionarSabor` podr칤a ser en `pedidoMejora.js`:
        /*
        function seleccionarSabor(sabor) {
            document.getElementById('sabor').value = sabor;
            const buttons = document.querySelectorAll('.sabor-opcion');
            buttons.forEach(btn => {
                if (btn.dataset.sabor === sabor) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        }
        */
    </script>
</body>
</html>